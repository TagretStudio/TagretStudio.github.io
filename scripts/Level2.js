define(["Images","LummingFactory","VisibleLummingFactory","ColorEnum","MusicFactory","PlatformFactory","DoorsFactory","Transition","MenuFactoryTest","ItemsLevel"],function(e,t,a,r,o,l,d,n,i,u){function c(e,t,a,r){var o=p.add.sprite(0,0,"platforms",1),l=o.width;o.kill();for(var d,n=0;n<Math.floor(Math.floor(r/l)/2)+1;n++)d=p.add.sprite(e+r/2-n*l,t,"platforms",6),d.anchor.set(0,0),d=p.add.sprite(e+r/2+n*l,t,"platforms",6),d.anchor.set(1,0);d=p.add.sprite(e,t,"platforms",4),d=p.add.sprite(e+r,t,"platforms",2),d.anchor.set(1,0)}function m(e,t){var a=(e.left+e.right)/2,r=t.left,o=t.right;if(a>r&&o>a){var l=e.collideWithDoor(t);1==l&&(f+=1,L.setText(f+"/"+s))}}var p=null,s=0,f=0,g=null,h=null,y=null,E=null,v=null,L=null,C=null,D={preload:function(){v=o.create("level2","media/audio/level.ogg"),p.load.image("cliquez","media/img/cliquezPourCommencer.png"),p.load.spritesheet("platforms","media/img/tiles3.png",32,32),a.init(p),l.init(p),d.init(p),i.init(p)},create:function(){f=0,v.play(),e.boot().create(),p.physics.startSystem(Phaser.Physics.ARCADE),h=p.add.group(),h.enableBody=!0,platform1=l.create(-200,100,!1),platform2=l.create(100,200,!1),platform3=l.create(400,300,!1),platform4=l.create(700,280,!1),platform5=l.create(0,504,!1),platform6=l.create(400,504,!1),h.add(platform1),h.add(platform2),h.add(platform3),h.add(platform4),h.add(platform5),h.add(platform6),c(0,0,4,300),c(0,64,4,500),E=p.add.group(),E.enableBody=!0,door1=d.create(r.getColorEnum().RED,0,470),door2=d.create(r.getColorEnum().YELLOW,600,470),lol=d.create(r.getColorEnum().YELLOW,0,270),E.add(door1),E.add(door2),y=p.add.group(),lum1=a.create(r.getColorEnum().RED,0,0,200),lum2=a.create(r.getColorEnum().YELLOW,100,0,-200),lum3=a.create(r.getColorEnum().YELLOW,500,0,0),s=3,L=p.add.text(750,0,f+"/"+s,{align:"center"}),y.add(lum1),y.add(lum2),y.add(lum3),C=i.create(),u.reinit(p);var t=this.add.sprite(100,300,"cliquez");t.scale.set(.7,.7),p.input.onDown.add(function(){p.paused&&(p.paused=!1,t.destroy())},p),p.paused=!0},update:function(){p.physics.arcade.collide(y,h),p.physics.arcade.overlap(y,E,m,null,p),p.physics.arcade.overlap(y,u.getGroupItem(),u.collideItem,null,p),C.update(),y.forEach(function(e){e.update()}),E.forEach(function(e){e.update()}),s==f&&n.nextState("MainMenu",v)}};return{init:function(e,t){p=e,g=t},getLevel2:function(){return D}}});